#!/usr/bin/env python3
import os
import random
import subprocess
import argparse
import colorama
from colorama import Fore
import pyxploitdb

class Decore:
    def random_banner(self):
        try:
            color = random.choice([Fore.YELLOW, Fore.RED, Fore.BLUE])
            print(color)
            ran = random.choice(["ban1.txt", "ban2.txt", "ban3.txt"])
            subprocess.run(["cat", f"banner/{ran}"])
        except OSError as e:
            print(f"Error displaying banner: {e}")

    def autor(self):
        print(Fore.GREEN + "autor: " + Fore.YELLOW + "DigitalNinja00")
        print(Fore.GREEN + "github: " + Fore.YELLOW + "https://github.com/DigitalNinja00")
        print(Fore.RESET + "This script uses the exploit database API")

if __name__ == "__main__":
    colorama.init()

    parser = argparse.ArgumentParser(description="OPTIONS FOR SEARCH EXPLOIT")
    parser.add_argument("-s", "--search", help="example: ./setup.py -s CVE-2021-4034")
    args = parser.parse_args()

    if args.search:
        decore = Decore()
        decore.random_banner()
        decore.autor()
        print("")

        try:
            result = pyxploitdb.searchCVE(args.search)
            for i, (key, value) in enumerate(result.items()):
                print(f"{Fore.RED}:{Fore.YELLOW}{key}")
                print(f"{Fore.RED}{value}")
        except Exception as e:
            print(f"Error searching for exploit: {e}")
