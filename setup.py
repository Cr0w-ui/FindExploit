#!/usr/bin/env python3
import os
import random
import subprocess
import pyxploitdb
import argparse
import colorama
from colorama import Fore

global yellow
global red
global blue

yellow = Fore.YELLOW
red = Fore.RED
blue = Fore.BLUE
class Decore:
	def random_banner():
		try:
			color = random.choice([yellow, red, blue])
			print(color)
			ran = random.choice(["ban1.txt", "ban2.txt", "ban3.txt"]);
			subprocess.run(["cat", f"banner/{ran}"]);
		except OSError as local:
			print(local);
	def autor():
		print(Fore.GREEN+"autor: "+Fore.YELLOW+"DigitalNinja00")
		print(Fore.GREEN+"github: "+Fore.YELLOW+"https://github.com/DigitalNinja00")
		print(Fore.RESET+"This script uses the exploit data base API")

parse = argparse.ArgumentParser("OPTIONS FOR SEARCH EXPLOIT");
parse.add_argument("-s", "--search", help="example: ./setup.py -s CVE-2021-4034");
args = parse.parse_args();

if(args.search):
	Decore.random_banner();
	Decore.autor();
	print("")
	log = pyxploitdb.searchCVE(args.search);
	locc = str(log)
	log1 = locc.split(", ")
	log2 = str(log1)
	log3 = log2.split("=")
	caracteres = "()[] \\ \" \'"
	lol = str(log3)
	table = str.maketrans('', '', caracteres)
	clean = lol.translate(table);
	mm = str(clean);
	mn = mm.split(",");
	for i, x in enumerate(mn):
		if i % 2 == 0:
			print(f"{red}:{yellow}{x}")
		else:
			cal = x.rstrip("\n")
			print(f"{red}{cal}")
